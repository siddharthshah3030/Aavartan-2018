var scene,camera,fieldOfView,aspectRatio,nearPlane,farPlane,renderer,container,HEIGHT,WIDTH,ambientLight,hemisphereLight,shadowLight,Colors={red:15881030,white:14209233,brown:5845806,pink:16095342,brownDark:2300175,blue:6865856},mousePos={x:0,y:0};function createScene(){HEIGHT=window.innerHeight,WIDTH=window.innerWidth,scene=new THREE.Scene,aspectRatio=WIDTH/HEIGHT,fieldOfView=60,nearPlane=1,farPlane=1e4,camera=new THREE.PerspectiveCamera(fieldOfView,aspectRatio,nearPlane,farPlane),scene.fog=new THREE.Fog(16243114,100,950),camera.position.x=0,camera.position.z=200,camera.position.y=100,(renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0})).setSize(WIDTH,HEIGHT),renderer.shadowMap.enabled=!0,(container=document.getElementById("world")).appendChild(renderer.domElement),window.addEventListener("resize",handleWindowResize,!1)}function handleWindowResize(){HEIGHT=window.innerHeight,WIDTH=window.innerWidth,renderer.setSize(WIDTH,HEIGHT),camera.aspect=WIDTH/HEIGHT,camera.updateProjectionMatrix()}function createLights(){hemisphereLight=new THREE.HemisphereLight(11184810,0,.9),(shadowLight=new THREE.DirectionalLight(16777215,.9)).position.set(150,350,350),shadowLight.castShadow=!0,shadowLight.shadow.camera.left=-400,shadowLight.shadow.camera.right=400,shadowLight.shadow.camera.top=400,shadowLight.shadow.camera.bottom=-400,shadowLight.shadow.camera.near=1,shadowLight.shadow.camera.far=1e3,shadowLight.shadow.mapSize.width=2048,shadowLight.shadow.mapSize.height=2048,scene.add(hemisphereLight),scene.add(shadowLight)}var sea,airplane,AirPlane=function(){this.mesh=new THREE.Object3D,this.mesh.name="airPlane";var e=new THREE.BoxGeometry(60,50,50,1,1,1),a=new THREE.MeshPhongMaterial({color:Colors.red,shading:THREE.FlatShading}),o=new THREE.Mesh(e,a);o.castShadow=!0,o.receiveShadow=!0,this.mesh.add(o);var n=new THREE.BoxGeometry(20,50,50,1,1,1),t=new THREE.MeshPhongMaterial({color:Colors.white,shading:THREE.FlatShading}),i=new THREE.Mesh(n,t);i.position.x=40,i.castShadow=!0,i.receiveShadow=!0,this.mesh.add(i);var s=new THREE.BoxGeometry(15,20,5,1,1,1),r=new THREE.MeshPhongMaterial({color:Colors.red,shading:THREE.FlatShading}),h=new THREE.Mesh(s,r);h.position.set(-35,25,0),h.castShadow=!0,h.receiveShadow=!0,this.mesh.add(h);var d=new THREE.BoxGeometry(40,8,150,1,1,1),l=new THREE.MeshPhongMaterial({color:Colors.red,shading:THREE.FlatShading}),w=new THREE.Mesh(d,l);w.position.set(0,0,0),w.castShadow=!0,w.receiveShadow=!0,this.mesh.add(w);var c=new THREE.BoxGeometry(20,10,10,1,1,1),E=new THREE.MeshPhongMaterial({color:Colors.brown,shading:THREE.FlatShading});this.propeller=new THREE.Mesh(c,E),this.propeller.castShadow=!0,this.propeller.receiveShadow=!0;var m=new THREE.BoxGeometry(1,100,20,1,1,1),p=new THREE.MeshPhongMaterial({color:Colors.brownDark,shading:THREE.FlatShading}),H=new THREE.Mesh(m,p);H.position.set(8,0,0),H.castShadow=!0,H.receiveShadow=!0,this.propeller.add(H),this.propeller.position.set(50,0,0),this.mesh.add(this.propeller)};function createPlane(){(airplane=new AirPlane).mesh.scale.set(.25,.25,.25),airplane.mesh.position.y=100,scene.add(airplane.mesh)}function createSea(){(sea=new Sea).mesh.position.y=-600,scene.add(sea.mesh)}function createSky(){sky=new Sky,sky.mesh.position.y=-600,scene.add(sky.mesh)}function loop(){updatePlane(),sea.mesh.rotation.z+=.005,sky.mesh.rotation.z+=.01,renderer.render(scene,camera),requestAnimationFrame(loop)}function updatePlane(){var e=normalize(mousePos.y,-.75,.75,25,175),a=normalize(mousePos.x,-.75,.75,-100,100);airplane.mesh.position.y=e,airplane.mesh.position.x=a,airplane.propeller.rotation.x+=.3}function normalize(e,a,o,n,t){return n+(Math.max(Math.min(e,o),a)-a)/(o-a)*(t-n)}function init(e){document.addEventListener("mousemove",handleMouseMove,!1),createScene(),createLights(),createPlane(),createSea(),createSky(),loop()}Sky=function(){this.mesh=new THREE.Object3D,this.nClouds=20,this.clouds=[];for(var e=2*Math.PI/this.nClouds,a=0;a<this.nClouds;a++){var o=new Cloud;this.clouds.push(o);var n=e*a,t=750+200*Math.random();o.mesh.position.y=Math.sin(n)*t,o.mesh.position.x=Math.cos(n)*t,o.mesh.position.z=-400-400*Math.random(),o.mesh.rotation.z=n+Math.PI/2;var i=1+2*Math.random();o.mesh.scale.set(i,i,i),this.mesh.add(o.mesh)}},Sea=function(){var e=new THREE.CylinderGeometry(600,600,800,40,10);e.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var a=new THREE.MeshPhongMaterial({color:Colors.blue,transparent:!0,opacity:.6,shading:THREE.FlatShading});this.mesh=new THREE.Mesh(e,a),this.mesh.receiveShadow=!0},Cloud=function(){this.mesh=new THREE.Object3D,this.mesh.name="cloud";for(var e=new THREE.CubeGeometry(20,20,20),a=new THREE.MeshPhongMaterial({color:Colors.white}),o=3+Math.floor(3*Math.random()),n=0;n<o;n++){var t=new THREE.Mesh(e.clone(),a);t.position.x=15*n,t.position.y=10*Math.random(),t.position.z=10*Math.random(),t.rotation.z=Math.random()*Math.PI*2,t.rotation.y=Math.random()*Math.PI*2;var i=.1+.9*Math.random();t.scale.set(i,i,i),t.castShadow=!0,t.receiveShadow=!0,this.mesh.add(t)}};mousePos={x:0,y:0};function handleMouseMove(e){var a=e.clientX/WIDTH*2-1,o=1-e.clientY/HEIGHT*2;mousePos={x:a,y:o}}window.addEventListener("load",init,!1);